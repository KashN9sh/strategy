### Чеклист реализации (изометрическая стратегия в стиле Anno)

- **Базовый движок (MVP)**
  - [x] Тики симуляции (фикс. шаг 30–60 Гц), пауза/скорости (0.5x/1x/2x/3x)
  - [x] Горячие клавиши и ребиндинг, конфиг (TOML)
  - [x] Сохранение/загрузка (JSON) с версионированием

- **Рендер и графика**
  - [x] Атлас тайлов и спрайтов зданий, блит с альфой
  - [x] Анимации воды (кадровая)
  - [x] Оверлеи: сетка, подсветка клетки/плотности леса
  - [x] Z-сортировка зданий
  - [ ] Дороги/угловые соединения

- **Мир и чанки**
  - [x] Генерация чанков в фоне, прогрев кольца
  - [ ] Выгрузка дальних чанков (LRU), лимит памяти
  - [~] Биомы: базовая шумовая карта, береговая линия
  - [x] Стабильный сид мира в сохранениях
  - [ ] Экспансия: новые регионы/острова (доки/переходы)
  - [ ] Точки интереса: тайники/караваны/бандиты (малые риски/награды)
  - [ ] Редкие ресурсы и исчерпаемость месторождений
  - [ ] (Опционально) Туман войны/разведка

- **Ввод/камеры**
  - [x] Зум со «снэпом» к пикселям (без швов), панорамирование
  - [ ] Плавность/инерция, перетаскивание правой/средней, ограничители

- **Строительство**
  - [x] Размещение, валидаторы (вода/занято)
  - [ ] План-режим (призраки), снос/перенос, возврат
  - [ ] Дороги с автоподбором спрайтов

- **Логистика и ресурсы**
  - [x] Базовые цепочки (лесоруб → дерево; дом потребляет/налог)
  - [ ] Склады/ёмкость, резервирование, отчёты «чего не хватает»
  - [ ] Транспорт: носильщики/повозки, маршруты по дорогам
  - [ ] Баланс: вход/выход в минуту, потребление жителями

- **Экономика и торговля**
  - [ ] Торговый пост (NPC) на краю карты, динамические цены
  - [ ] Контракты/квоты на поставку, базовая дипломатия (нейтрально)
  - [ ] Торговые караваны (спавнятся по расписанию)

- **Население и потребности (Anno-подобное)**
  - [ ] Дома уровней (уровень 1..N), апгрейды при удовлетворении нужд
  - [ ] Потребности: базовые/роскошь, счастье/налоги
  - [ ] Рынки/церкви/развлечения: радиусы влияния, покрытие
  - [ ] Панель дома: статус, чего не хватает, прогресс апгрейда

- **AI и путь**
  - [ ] Поиск пути (A*) на изометрической сетке с весами дорог
  - [ ] Распределение задач (jobs), приоритеты, очереди заявок
  - [ ] Избежание коллизий/пробок (simple reservation)

- **UI/UX**
  - [x] Верхняя панель ресурсов (масштабируемая), FPS, пауза/скорость
  - [x] Меню строительства (кнопки + хоткеи, кликабельные)
  - [ ] Tooltip’ы, инфо-панель здания, окно статистики
  - [ ] Мини-задачи/чеклист целей (справа), прогресс-бар
  - [ ] Визуализация логистики: линии доставки на наведении, тепловая карта трафика
  - [ ] Панель «узкие места»: недоставки/переполнения складов
  - [ ] Достижения/вехи (показывать при выполнении)

- **Аудио**
  - [ ] Фоновая музыка, звуки размещения/производства
  - [ ] Громкость/мьют в настройках

- **Производительность**
  - [ ] Профилирование (FPS-граф, время шагов), метрики
  - [ ] Кэш проекций экран→тайл на фрейм, отсечение вне экрана
  - [ ] Инкрементальные обновления слоёв/оверлеев
  - [ ] Метрики вовлечения (для себя): time-to-first-upgrade, time-to-first-trade

- **Ивенты/сезоны**
  - [ ] Сезоны (влияние на урожай/скорости дорог)
  - [ ] Лёгкие ивенты: «урожайный год», «дождь», «сбои поставок»

- **Инструменты/моды**
  - [ ] Датадривен-дефы зданий/ресурсов (TOML/YAML)
  - [ ] Редактор карты/биомов, сид-менеджер
  - [ ] Скриншоты/экспорт реплея (seed + действия)

- **Сборки и платформа**
  - [ ] Mac/Win/Linux таргеты, иконка/версия
  - [ ] Настройки окна/VSYNC/Fullscreen, проверка на разных DPI

### Приоритеты

- MVP: рендер/камера без артефактов, чанки с фоновой генерацией, строительство/снос, базовые цепочки, склады, панель ресурсов, сохранение/загрузка.
- Next: дороги+логистика, оверлеи, A*, потребности домов и налоги.
- Later: анимации, аудио, моддинг, редактор, продвинутые биомы.

### Вовлекающие «петли» (для дизайна)

- Короткая (1–3 мин): быстрый эффект от постройки, отчёт «+X/мин», всплывающие +1
- Средняя (10–30 мин): расширение/оптимизация логистики, склады-«узлы», снятие пробок
- Длинная (1–3 ч): освоение новых биомов/торговля/редкие ресурсы, сценарные цели

### Системы, которые дают «вкусные» решения

- Потребности и уровни домов
  - [ ] Уровни T1→T2→T3 с требованиями (еда/вода/одежда/роскошь)
  - [ ] Счастье/налоги: баланс дохода и роста населения
- Логистика как головоломка
  - [ ] Носильщики/повозки, веса дорог, пробки и обходы
  - [ ] Склады-буферы, резервирование, «узкие места» и отчёты
- Производственные компромиссы
  - [ ] Ветки апгрейдов: скорость vs. ресурс/энергия/рабочие
  - [ ] Исчерпаемость/редкость сырья, альтернативные рецепты
- Карта и экспансия
  - [ ] Биомы/острова с разной «плодородностью», редкие точки интереса
  - [ ] Риски/награды: тайники, караваны, бандиты (малые ивенты)
- Торговля и цены
  - [ ] Динамические цены, контракты/квоты, окна поставок
  - [ ] Логистика торговли: доки, караваны, складские хабы
- Сезоны и ивенты
  - [ ] Влияние на урожай/скорость дорог/пожары/штормы
  - [ ] Предупреждения и подготовка (колодцы, запасы, диверсификация)
- Миссии и цели
  - [ ] Короткие квесты в UI (накопи X, покрой Y%), награды/разблокировки
  - [ ] Достижения и долгосрочные сценарные задачи

### Итерационный план (3 спринта)

- Итерация 1 (Дороги и логистика)
  - [ ] Дороги с автосоединениями спрайтов (4-соседа)
  - [ ] A* с весами дорог, простые носильщики
  - [ ] Склады: ёмкость, резервирование, панель «узкие места»

- Итерация 2 (Жители и потребности)
  - [ ] Дома T1→T2 при покрытии базовых нужд
  - [ ] Рынок/колодец с радиусом покрытия; налоги/счастье
  - [ ] Инфо-панель дома + tooltip’ы UI

- Итерация 3 (Торговля и ивенты)
  - [ ] Торговый пост NPC, динамические цены, контракты
  - [ ] 1–2 ивента/сезона, влияющих на планирование
  - [ ] Мини-задачи/чеклист целей в UI

### Критерии готовности MVP

- 60 FPS в типовом окне; без швов на любом зуме
- Сохранение/загрузка воспроизводит мир и здания
- Лесоруб/дом/склад работают, ресурсы считаются корректно
- Нет утечек при перемещении камеры (чанки грузятся/выгружаются)


